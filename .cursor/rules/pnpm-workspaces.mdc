---
description:
globs:
alwaysApply: true
---

# Your rule content

Overview
This monorepo uses pnpm workspaces. Current codebases:
• apps/api — NestJS backend service
• apps/ui — Next.js (React/TypeScript) web client
• apps/workflows — Temporal TypeScript workers (orchestrator + algorithm worker) and activities
• packages/reputation-algorithms — ranking and scoring logic
• packages/database — Mongo models/schemas and data helpers
• packages/storage — storage abstraction and helpers
• packages/algorithm-validator — algorithm schema validation utilities
• packages/deepfunding-portal-api — DeepFunding Portal API client/resources (TypeScript)

Tooling and Infrastructure
• pnpm for workspace management; dependency scripts run with `pnpm --filter ...` across `apps/*` and `packages/*`.
• Containerization for every service; Docker images drive all environments.
• CI/CD via GitHub Actions to build/push images and promote between envs.
• Biome for lint/format, Vitest for testing, lefthook for git hooks, semantic-release for automated releases.

Quality Bar
• Code must stay clean, modular, and follow best practices by default.
• Prefer typed interfaces, shared utilities, and small, focused modules.
• Keep temporal activities/workflows deterministic and side-effect aware.

Branch and Environment Strategy
• Preview — Pull Preview spins up ephemeral envs per PR for design/QA.
• Staging — merges to main tag images as latest; Watchtower auto-redeploys.
• Production — manual promotion; Watchtower redeploys the vetted staging image.

Branching Model
GitHub Flow with short-lived branches that open PRs, get review, and merge to main.

Rollbacks
Re-tag the prior production image and let Watchtower redeploy for fast rollback.
