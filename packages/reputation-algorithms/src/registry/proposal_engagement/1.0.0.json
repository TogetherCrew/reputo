{
    "key": "proposal_engagement",
    "name": "Proposal Engagement",
    "category": "Engagement",
    "summary": "Scores a user’s impact through proposals by rewarding funded & concluded work with strong community ratings and penalizing unfunded low-rated proposals. Uses time decay and simple percentile mapping to reduce whale dominance.",
    "description": "### Proposal Engagement (Proposals)\nThis algorithm scores users based on how they contribute through **proposals**.\n\n**How it works (simple):**\n- Each proposal gets a **community rating** (1–5), normalized to **0..1**.\n- If a proposal is **funded & concluded**, it adds a reward scaled by `fundedConcludedProposalRewardWeight`.\n- If a proposal is **unfunded**, it adds a penalty scaled by `unfundedProposalPenaltyWeight` (stronger when rating is low).\n- A **time decay policy** makes recent proposals matter more:\n  - `engagementWindowMonths` (older than this → weight 0)\n  - `monthlyDecayRatePercent` (drops each month bucket)\n- To prevent a few heavy users from dominating, raw totals are mapped into a final score using **simple percentile bands** with **linear scaling**:\n  - Bottom `bottomPercentileThreshold%` → `minimumRankMappedScore`\n  - Top `topPercentileThreshold%` → `maximumRankMappedScore`\n  - Middle users scale linearly between min/max\n\n**Inputs:**\n- No manual file upload.\n- Data is fetched from DeepFunding Portal APIs.\n\n**Output:**\n- Per-user proposal engagement score that rewards successful, well-rated work while limiting domination by a few heavy users.",
    "version": "1.0.0",
    "inputs": [
        {
            "key": "funded_concluded_proposal_weight",
            "label": "Funded Concluded Proposal Weight",
            "description": "Reward strength for funded + concluded proposals.",
            "type": "number",
            "min": 0,
            "max": 10,
            "default": 1.0,
            "step": 0.1,
            "uiHint": {
                "widget": "slider"
            },
            "required": true
        },
        {
            "key": "unfunded_proposal_weight",
            "label": "Unfunded Proposal Weight",
            "description": "Penalty strength for unfunded proposals.",
            "type": "number",
            "min": 0,
            "max": 10,
            "default": 1,
            "step": 0.1,
            "uiHint": {
                "widget": "slider"
            },
            "required": true
        },
        {
            "key": "engagement_window_months",
            "label": "Engagement Window (Months)",
            "description": "Engagement window in months; proposals older than this contribute 0.",
            "type": "number",
            "min": 1,
            "max": 12,
            "default": 12,
            "step": 1,
            "required": true
        },
        {
            "key": "monthly_decay_rate_percent",
            "label": "Monthly Decay Rate (%)",
            "description": "Decay rate per month bucket (%). Each month reduces proposal weight by this percentage.",
            "type": "integer",
            "min": 0,
            "max": 100,
            "default": 10,
            "step": 1,
            "required": true
        },
        {
            "key": "decay_bucket_size_months",
            "label": "Decay Bucket Size (Months)",
            "description": "Fixed bucket size used for time decay calculations.",
            "type": "integer",
            "default": 1,
            "step": 1,
            "required": false
        }
    ],
    "outputs": [
        {
            "key": "proposal_engagement",
            "label": "Proposal Engagement by User",
            "description": "Proposal engagement score for each user",
            "type": "csv",
            "csv": {
                "hasHeader": true,
                "delimiter": ",",
                "columns": [
                    {
                        "key": "collection_id",
                        "type": "string",
                        "description": "Unique user identifier"
                    },
                    {
                        "key": "proposal_engagement",
                        "type": "number",
                        "description": "Proposal engagement score"
                    }
                ]
            }
        }
    ],
    "runtime": {
        "taskQueue": "typescript-worker",
        "activity": "proposal_engagement"
    }
}
